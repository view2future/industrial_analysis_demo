# 三页面现代化改造计划（深色主题与可访问性）

## 范围与目标
- 页面：
  1. 流式展示 `templates/stream_report.html`
  2. 报告详情 `templates/report_view.html`
  3. 首页 `templates/index_enhanced.html`
- 统一现代科技风格：深色/霓虹点缀、现代字体、玻璃/新拟态质感
- 保持现有功能与逻辑不变；主要通过 CSS/JS 增强与覆写实现
- 满足 WCAG 2.1 AA、响应式与性能优化，支持明暗双主题

## 设计系统与主题
- 扩展 `static/css/theme-modern.css`：
  - 新增 `theme-dark` 与 `theme-light` 两套 CSS 变量（颜色、阴影、渐变、文本对比）
  - 自动检测 `prefers-color-scheme`，并提供切换按钮（状态存储 `localStorage`）
  - 字体：标题使用 `Plus Jakarta Sans`；正文使用同栈并优化字距与行高
- 微交互：统一 `hover/active/focus/disabled/loading`，细化阴影与高光强度

## 页面级实现
### 1) 流式展示页
- 深色背景与霓虹点缀：状态面板、进度条 `progress-glow` 霓虹内发光；内容区玻璃卡轻模糊
- 数据展示卡重排：网格卡片（统计/计时/LLM 服务）统一圆角与悬浮动画；移动端下栅格断点优化
- 动效与数据流元素：背景径向光晕与缓慢移动的渐变网格（CSS 动画）；保留性能友好（禁用大量模糊在移动端）
- 响应式：70/30 布局在窄屏降级为 100% 堆叠；滚动容器添加现代滚动条与滚动掩膜
- 无障碍：进度文本读屏可达；阶段指示键盘焦点可见；按钮 `aria-label` 与触达面积 ≥40×40

### 2) 报告详情页
- Markdown到美观视图：使用现有 `marked.js` 在前端渲染 `full_content` 为 HTML
- 语法高亮：引入 `highlight.js`（CDN），为 `pre code` 自动高亮；提供暗/明主题适配
- 排版优化：提升段落行高/段距、标题层级间距、可读宽度；引文块与表格统一样式
- 目录导航：扫描渲染后标题生成 TOC（侧栏或页内锚点），支持点击定位与滚动高亮
- 打印/PDF：
  - 打印：专用 print CSS，隐藏非内容区并分页优化；按钮触发 `window.print()`
  - PDF：可选 `html2pdf.js`（CDN）生成离线 PDF，保留样式与目录
- 无障碍：对比度与键盘导航可达；图像/代码块可读文本；标题锚提供可见焦点态

### 3) 首页
- Logo统一：替换不美观/不一致图形为统一风格（暂用线性图标或SVG占位）；尺寸与色彩统一
- 展示区布局：网格卡片与 Hero 渐变优化；Logo区添加轻入场与悬浮过渡
- 动效：卡片/Logo 平滑过渡与级联延时；移动端减少动效强度（尊重 `prefers-reduced-motion`）
- 点击区域：图标按钮与卡片可达区域 ≥44×44；键盘焦点明显

## 可访问性（WCAG 2.1 AA）
- 对比度检查：主文本/次文本/按钮/徽章满足 AA；暗主题强化对比
- 键盘可达：所有交互可键盘访问；焦点样式统一且可见
- 语义与ARIA：为图标按钮与进度/目录添加 `aria-*` 与 role；跳转锚可读

## 性能优化
- 字体 `font-display: swap`、CDN `preconnect`、脚本 `defer`/`async`
- 动效降级：移动端减少模糊与阴影；尽量使用 `transform/opacity` 动画
- 资源懒加载：图片/图标 `loading=lazy`；仅需要的页面加载 highlight/html2pdf

## 质量与验证
- 跨浏览器/设备测试矩阵按 `docs/ui-test-plan.md`
- 截图对比按 `docs/ui-diff-screenshots.md` 输出
- 代码质量：ESLint/Stylelint全局运行，修复告警

## 交付物
- 扩展主题与组件：`static/css/theme-modern.css`（新增暗/明主题与增强组件）
- 页面增强脚本：
  - 流式页：微交互与数据流动画脚本（轻量）
  - 详情页：Markdown渲染、TOC生成、语法高亮、打印/PDF
- 文档：UI组件库文档、测试计划、截图对比文档更新
- 高保真稿：Figma组件库与三页高保真，包含深/浅主题变体与交互说明

## 时间表（首版24小时）
- T+6h：流式页暗主题与卡片/进度升级、首页Logo区改造初版
- T+12h：详情页 Markdown 渲染与高亮/排版/TOC；打印样式
- T+18h：无障碍细节与性能优化、响应式细节
- T+24h：测试与截图对比初稿、Figma初版链接回传

——请确认图标统一库的选择（Material Symbols 或 Ant Design Icons），我将据此生成首页Logo与特殊图标的候选集并开始实施。