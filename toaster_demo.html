<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toaster Demo</title>
    <style>
        body {
            background-color: #f0f2f5;
            font-family: sans-serif;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .controls {
            position: fixed;
            top: 20px;
            left: 20px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        button {
            display: block;
            margin: 5px 0;
            padding: 8px 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div class="controls">
        <h3>Controls</h3>
        <button onclick="addMockTask('success')">Add Success Task</button>
        <button onclick="addMockTask('failed')">Add Failed Task</button>
        <button onclick="toggleProcessing()">Toggle Processing State</button>
    </div>

    <!-- Scripts -->
    <script>
        // Mock API
        const mockTasks = [];
        
        // Override fetch
        window.fetch = async (url) => {
            if (url === '/api/tasks') {
                return {
                    json: async () => ({ tasks: mockTasks })
                };
            }
        };

        function addMockTask(status) {
            const id = Date.now().toString();
            mockTasks.push({
                task_id: id,
                city: 'City ' + Math.floor(Math.random()*100),
                industry: 'Ind ' + Math.floor(Math.random()*100),
                status: status === 'success' ? 'completed' : 'failed',
                progress: 100
            });
            // Trigger update immediately
            if (window.toasterSystem) window.toasterSystem.fetchTasks();
        }

        function toggleProcessing() {
            // Add a processing task
            const existing = mockTasks.find(t => t.status === 'processing');
            if (existing) {
                mockTasks.splice(mockTasks.indexOf(existing), 1);
            } else {
                mockTasks.push({
                    task_id: 'proc',
                    city: 'Proc',
                    industry: 'Test',
                    status: 'processing',
                    progress: 50
                });
            }
            if (window.toasterSystem) window.toasterSystem.fetchTasks();
        }
    </script>
    <script src="/static/js/toaster.js"></script>

</body>
</html>
